<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Select Size</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    :root {
      --bg: #020617;
      --card: #020617;
      --border: #1e293b;
      --accent: #38bdf8;
      --accent-dark: #0284c7;
      --text: #e5e7eb;
      --muted: #94a3b8;
      --disabled: #334155;
    }

    * {
      box-sizing: border-box;
      font-family: system-ui, -apple-system, BlinkMacSystemFont;
    }

    html, body {
      margin: 0;
      height: 100%;
      background: radial-gradient(circle at top, #020617, #000);
      color: var(--text);
      overflow: hidden;
    }

    .kiosk {
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .card {
      width: 760px;
      background: var(--card);
      border-radius: 28px;
      padding: 36px;
      box-shadow: 0 40px 100px rgba(0,0,0,0.7);
    }

    h1 {
      font-size: 28px;
      margin-bottom: 6px;
      text-align: center;
    }

    .subtitle {
      text-align: center;
      color: var(--muted);
      margin-bottom: 32px;
      font-size: 16px;
    }

    .sizes {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 24px;
    }

    .size-card {
      border-radius: 22px;
      padding: 24px;
      border: 2px solid var(--border);
      background: #020617;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      height: 260px;
    }

    .size-card.disabled {
      opacity: 0.35;
    }

    .size-title {
      font-size: 22px;
      font-weight: 600;
      text-transform: capitalize;
    }

    .availability {
      margin-top: 6px;
      color: var(--muted);
      font-size: 14px;
    }

    .price {
      margin: 20px 0;
      font-size: 34px;
      font-weight: 700;
    }

    .price span {
      font-size: 16px;
      color: var(--muted);
      font-weight: 500;
    }

    .btn {
      width: 100%;
      padding: 18px;
      font-size: 20px;
      font-weight: 600;
      border-radius: 16px;
      border: none;
      cursor: pointer;
      background: linear-gradient(180deg, var(--accent), var(--accent-dark));
      color: #020617;
      transition: transform 0.1s ease;
    }

    .btn:active {
      transform: scale(0.97);
    }

    .btn:disabled {
      background: var(--disabled);
      color: var(--muted);
      cursor: not-allowed;
    }
  </style>
</head>

<body>
  <div class="kiosk">
    <div class="card">
      <h1>Select Parcel Size</h1>
      <div class="subtitle">
        Available compartments at this locker
      </div>

      <div class="sizes">

        <!-- SMALL -->
        <div class="size-card <%= availability.small.free === 0 ? 'disabled' : '' %>">
          <div>
            <div class="size-title">Small</div>
            <div class="availability">
              <%= availability.small.free %> of <%= availability.small.total %> available
            </div>

            <div class="price">
              ₹<%= PRICE.small %>
              <span>/ hour</span>
            </div>
          </div>

          <button
            class="btn"
            <%= availability.small.free === 0 ? 'disabled' : '' %>
            onclick="selectSize('small')"
          >
            Select Small
          </button>
        </div>

        <!-- MEDIUM -->
        <div class="size-card <%= availability.medium.free === 0 ? 'disabled' : '' %>">
          <div>
            <div class="size-title">Medium</div>
            <div class="availability">
              <%= availability.medium.free %> of <%= availability.medium.total %> available
            </div>

            <div class="price">
              ₹<%= PRICE.medium %>
              <span>/ hour</span>
            </div>
          </div>

          <button
            class="btn"
            <%= availability.medium.free === 0 ? 'disabled' : '' %>
            onclick="selectSize('medium')"
          >
            Select Medium
          </button>
        </div>

        <!-- LARGE -->
        <div class="size-card <%= availability.large.free === 0 ? 'disabled' : '' %>">
          <div>
            <div class="size-title">Large</div>
            <div class="availability">
              <%= availability.large.free %> of <%= availability.large.total %> available
            </div>

            
          </div>

          <button
            class="btn"
            <%= availability.large.free === 0 ? 'disabled' : '' %>
            onclick="selectSize('large')"
          >
            Select Large
          </button>
        </div>

      </div>
    </div>
  </div>

  <script>
    function selectSize(size) {
      fetch("/api/kiosk/unlock", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ size })
      })
      .then(res => {
        if (res.ok) {
          window.location.href = "/kiosk/unlocking";
        } else {
          alert("No compartment available for this size");
        }
      });
    }
  </script>
</body>
</html>
